<UserControl x:Class="AVCNDB.WPF.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:vm="clr-namespace:AVCNDB.WPF.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:SettingsViewModel}"
             Background="{DynamicResource MaterialDesignBackground}">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel MaxWidth="800" HorizontalAlignment="Left">
            
            <!-- Titre -->
            <TextBlock Text="ParamÃ¨tres" 
                       Style="{StaticResource TitleH1Style}"
                       Margin="0,0,0,24"/>

            <!-- ============================================
                 SECTION APPARENCE
            ============================================ -->
            <Border Style="{StaticResource ElevatedCardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸŽ¨ Apparence" 
                               Style="{StaticResource TitleH3Style}"
                               Margin="0,0,0,20"/>

                    <!-- ThÃ¨me -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="ThÃ¨me de l'application"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="Choisissez entre le mode clair et le mode sombre"
                                       Style="{StaticResource SubtitleStyle}"/>
                        </StackPanel>

                        <ComboBox Grid.Column="1"
                                  Width="200"
                                  SelectedItem="{Binding SelectedTheme}"
                                  Style="{StaticResource MaterialDesignOutlinedComboBox}">
                            <ComboBoxItem Content="Clair"/>
                            <ComboBoxItem Content="Sombre"/>
                            <ComboBoxItem Content="SystÃ¨me"/>
                        </ComboBox>
                    </Grid>

                    <Separator Margin="0,8"/>

                    <!-- Couleur primaire -->
                    <Grid Margin="0,16,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Couleur primaire"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="Couleur principale de l'interface"
                                       Style="{StaticResource SubtitleStyle}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Border Width="32" Height="32" 
                                    CornerRadius="16" 
                                    Background="#1976D2" 
                                    BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="2"
                                    Margin="4"/>
                            <Border Width="32" Height="32" 
                                    CornerRadius="16" 
                                    Background="#2E7D32" 
                                    Margin="4"/>
                            <Border Width="32" Height="32" 
                                    CornerRadius="16" 
                                    Background="#7B1FA2" 
                                    Margin="4"/>
                            <Border Width="32" Height="32" 
                                    CornerRadius="16" 
                                    Background="#D32F2F" 
                                    Margin="4"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- ============================================
                 SECTION BASE DE DONNÃ‰ES
            ============================================ -->
            <Border Style="{StaticResource ElevatedCardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ—„ï¸ Base de donnÃ©es" 
                               Style="{StaticResource TitleH3Style}"
                               Margin="0,0,0,20"/>

                    <!-- Serveur -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="0"
                                 Text="{Binding DatabaseServer, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Serveur"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,8,0"/>

                        <TextBox Grid.Column="1"
                                 Text="{Binding DatabasePort, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Port"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="8,0,0,0"/>
                    </Grid>

                    <!-- Base et utilisateur -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBox Grid.Column="0"
                                 Text="{Binding DatabaseName, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Nom de la base"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="0,0,8,0"/>

                        <TextBox Grid.Column="1"
                                 Text="{Binding DatabaseUser, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Utilisateur"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Margin="8,0,0,0"/>
                    </Grid>

                    <!-- Mot de passe -->
                    <PasswordBox materialDesign:HintAssist.Hint="Mot de passe"
                                 Style="{StaticResource MaterialDesignOutlinedPasswordBox}"
                                 Margin="0,0,0,16"/>

                    <!-- Bouton test -->
                    <StackPanel Orientation="Horizontal">
                        <Button Command="{Binding TestConnectionCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                Margin="0,0,16,0">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="DatabaseCheck" Width="18" Height="18" VerticalAlignment="Center"/>
                                <TextBlock Text="Tester la connexion" Margin="8,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <!-- Statut connexion -->
                        <Border CornerRadius="4" 
                                Padding="12,8"
                                Visibility="{Binding ConnectionTested, Converter={StaticResource BoolToVis}}">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Background" Value="{StaticResource ErrorLightBrush}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ConnectionSuccess}" Value="True">
                                            <Setter Property="Background" Value="{StaticResource SuccessLightBrush}"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <TextBlock>
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="âŒ Ã‰chec de connexion"/>
                                        <Setter Property="Foreground" Value="{StaticResource ErrorDarkBrush}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ConnectionSuccess}" Value="True">
                                                <Setter Property="Text" Value="âœ“ Connexion rÃ©ussie"/>
                                                <Setter Property="Foreground" Value="{StaticResource SuccessDarkBrush}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- ============================================
                 SECTION ALERTES
            ============================================ -->
            <Border Style="{StaticResource ElevatedCardStyle}" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="ðŸ”” Alertes" 
                               Style="{StaticResource TitleH3Style}"
                               Margin="0,0,0,20"/>

                    <!-- Seuil stock bas -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="150"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Seuil d'alerte stock"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="Nombre d'unitÃ©s en dessous duquel une alerte est dÃ©clenchÃ©e"
                                       Style="{StaticResource SubtitleStyle}"/>
                        </StackPanel>

                        <TextBox Grid.Column="1"
                                 Text="{Binding StockAlertThreshold, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Seuil"
                                 materialDesign:TextFieldAssist.SuffixText="unitÃ©s"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                    </Grid>

                    <Separator Margin="0,8"/>

                    <!-- Jours avant pÃ©remption -->
                    <Grid Margin="0,16,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="150"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Alerte pÃ©remption"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="Nombre de jours avant la date de pÃ©remption pour dÃ©clencher l'alerte"
                                       Style="{StaticResource SubtitleStyle}"/>
                        </StackPanel>

                        <TextBox Grid.Column="1"
                                 Text="{Binding ExpiryAlertDays, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="Jours"
                                 materialDesign:TextFieldAssist.SuffixText="jours"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- ============================================
                 SECTION Ã€ PROPOS
            ============================================ -->
            <Border Style="{StaticResource ElevatedCardStyle}">
                <StackPanel>
                    <TextBlock Text="â„¹ï¸ Ã€ propos" 
                               Style="{StaticResource TitleH3Style}"
                               Margin="0,0,0,20"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Logo -->
                        <Border Grid.Column="0"
                                Background="{StaticResource PrimaryBrush}"
                                CornerRadius="12"
                                Padding="20"
                                Margin="0,0,24,0">
                            <TextBlock Text="ðŸ¥" 
                                       FontSize="48"
                                       Foreground="White"/>
                        </Border>

                        <!-- Informations -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="AVICENNA DB"
                                       FontSize="24"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryDarkBrush}"/>
                            <TextBlock Text="Base de DonnÃ©es Pharmaceutique"
                                       Style="{StaticResource SubtitleStyle}"
                                       Margin="0,4,0,12"/>

                            <TextBlock Margin="0,0,0,4">
                                <Run Text="Version :" FontWeight="SemiBold"/>
                                <Run Text="2.0.0"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,0,0,4">
                                <Run Text="Framework :" FontWeight="SemiBold"/>
                                <Run Text=".NET 8.0 + WPF"/>
                            </TextBlock>

                            <TextBlock Margin="0,0,0,4">
                                <Run Text="DÃ©veloppÃ© par :" FontWeight="SemiBold"/>
                                <Run Text="AVCNA Team"/>
                            </TextBlock>

                            <TextBlock Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="0,8,0,0">
                                <Run Text="Â© 2024 - Tous droits rÃ©servÃ©s"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Bouton sauvegarder -->
            <Button Command="{Binding SaveSettingsCommand}"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Background="{StaticResource SuccessBrush}"
                    Foreground="White"
                    HorizontalAlignment="Right"
                    Margin="0,24,0,0"
                    Padding="24,12">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="ContentSave" Width="18" Height="18" VerticalAlignment="Center"/>
                    <TextBlock Text="Enregistrer les paramÃ¨tres" Margin="8,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </ScrollViewer>
</UserControl>
